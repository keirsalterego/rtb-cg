# rtb-cg: tpde backend driver dev log

started working on this to build a standalone backend driver for the tpde project. the goal is to bridge rust's llvm-ir output directly to the tpde c++ backend without getting stuck in the mess of a full `codegen_ssa` implementation.

## timeline & progress


### feb 5: advanced ssa & phi nodes
* refactored `rtb-core` to support complex control flow.
* added `Phi` and `Select` variants to the `Instruction` enum.
* **why:** needed a way to handle ssa merges when rust code branches (like in `if/else` blocks).
* finalized the `unsafe extern "C"` definitions to satisfy rust's ffi safety requirements.

### feb 4: bridging rust to c++
* set up the `cc` crate in `rtb-ffi` to compile the c++ backend code.
* wrote the initial `bridge.cpp` to verify linkage.
* hit some linker errors but fixed them by ensuring `build.rs` tracks the c++ sources correctly.

### feb 3: the "overflow" discovery
* started analyzing the ir generated by `cg_llvm` for basic math.
* **blocker found:** rust (in debug mode) generates safety intrinsics like `@llvm.sadd.with.overflow`.
* **issue:** tpde likely won't support these complex intrinsics out of the box.
* **plan:** implement a pre-processor in `rtb-cli` to strip these or compile with `-C overflow-checks=off` for the prototype.

### feb 2: project kickoff
* initialized the `rtb-cg` monorepo.
* decided to go with a workspace structure:
    * `rtb-core`: pure rust logic for ssa mapping.
    * `rtb-ffi`: the bridge to c++.
    * `rtb-cli`: the driver executable.
* set up the `Makefile` workflow to generate raw llvm-ir from rust sources (`rustc --emit=llvm-ir`).
